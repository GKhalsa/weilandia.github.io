<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>.Flatten Marquez and the Illusion of Magic - exported from Medium</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 20px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 18px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspect-ratio-fill {
        padding-bottom: 0 !important;
      }
      </style></head><body><article>
<header>
<h1>.Flatten Marquez and the Illusion of Magic</h1>
</header>
<section data-field="subtitle">
The world was so recent that many things lacked names. In order to understand, it was necessary to point. I arrived with everything I owned…
</section>
<section data-field="body">
<section name="bbce" class=" section--body section--first section--last"><div class="section-divider layoutSingleColumn"><hr class="section-divider"></div><div class="section-content"><div class="section-inner layoutSingleColumn"><h3 name="6bec" id="6bec" class="graf--h3 graf--first">.Flatten Marquez and the Illusion of Magic</h3><p name="1b13" id="1b13" class="graf--p graf-after--h3">The world was so recent that many things lacked names. In order to understand, it was necessary to point. I arrived with everything I owned; a small burden compared to the weight of the fear of wasted time. A future put on hold for an idea of a thing I barely knew.</p><p name="984f" id="984f" class="graf--p graf-after--p">Can you flatten dimensions? An eight-key magic trick for the aged, but what is real? How is a thing? This was my first challenge in the world of Ruby. A week ago, I could conceptualize how a computer might do this, but I could only point. The world was so recent then. Let’s flatten, without magic.</p><figure name="b64b" id="b64b" class="graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 101px;"><div class="aspect-ratio-fill" style="padding-bottom: 14.399999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*HGL_r0hRaz0_c7nhuXsosw.png" data-width="958" data-height="138" data-action="zoom" data-action-value="1*HGL_r0hRaz0_c7nhuXsosw.png"><img src="https://cdn-images-1.medium.com/freeze/max/60/1*HGL_r0hRaz0_c7nhuXsosw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*HGL_r0hRaz0_c7nhuXsosw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*HGL_r0hRaz0_c7nhuXsosw.png"></noscript></div></div></figure><p name="4f16" id="4f16" class="graf--p graf-after--figure">Above, we have a multi-dimensional Array that needs to be stored in one dimension and printed as a String. The aged would tell you this is quite easy. Just call .flatten on “buendia” and we’ve got a one-dimensional Array we can easily manipulate. Accepting this advice is akin to only being able to multiply on a calculator — It will work, but you’ll never truly understand any corollary to the concept of putting groups together. Instead, one should use a tool, like a calculator, only when it’s function is that of efficiency and not of understanding.</p><p name="c066" id="c066" class="graf--p graf-after--p">So, let’s break down how we came to understand the magic. We figured that in order to simplify “buendia” into a one-dimensional Array, we would have to iterate through each element in the Array and see which elements were themselves Arrays. Once we knew this, we could leave elements that were not Arrays alone and focus on transforming elements that were Arrays into non-arrays:</p><figure name="8d69" id="8d69" class="graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 208px;"><div class="aspect-ratio-fill" style="padding-bottom: 39.5%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*yK1L0taoqTjR7qKt7sFnww.png" data-width="526" data-height="208" data-action="zoom" data-action-value="1*yK1L0taoqTjR7qKt7sFnww.png"><img src="https://cdn-images-1.medium.com/freeze/max/60/1*yK1L0taoqTjR7qKt7sFnww.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*yK1L0taoqTjR7qKt7sFnww.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*yK1L0taoqTjR7qKt7sFnww.png"></noscript></div></div></figure><p name="8ea8" id="8ea8" class="graf--p graf-after--figure">Here, we defined the method “flatten_marquez” which takes the parameter “quote_array” (which is where we will ultimately put “buendia”). Next, we set the variable “index” equal to zero, which we will use to help us iterate through the different elements of “buendia”. Then, we told the computer, “If we are still in the original array, ask if the element we are currently looking at is itself an Array.” Next, we defined what the computer should do if an element we came across in an Array was itself an Array:</p><figure name="0469" id="0469" class="graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 220px;"><div class="aspect-ratio-fill" style="padding-bottom: 41.8%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*-X4PnKIPdzCWV0PLjFe6Yw.png" data-width="612" data-height="256" data-action="zoom" data-action-value="1*-X4PnKIPdzCWV0PLjFe6Yw.png"><img src="https://cdn-images-1.medium.com/freeze/max/60/1*-X4PnKIPdzCWV0PLjFe6Yw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*-X4PnKIPdzCWV0PLjFe6Yw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*-X4PnKIPdzCWV0PLjFe6Yw.png"></noscript></div></div></figure><p name="63aa" id="63aa" class="graf--p graf-after--figure">Here, the program is saying, “Okay element, I know you are an Array. I just have one more question: Are you an empty Array?”</p><p name="f175" id="f175" class="graf--p graf-after--p">If the element, that is an Array, is empty, then the program will simply delete that element. If the element/Array is not empty, the program goes on to do the most complicated part of our demystified flatten. First, the program tells the computer that “inner_quote_piece” should equal “quote_piece.shift”. To illustrate this, let’s look a a simple Array: a = [1,2,3]. If we call “shift” on “a”, we get “a.shift = [1]”. It simply returns the first element in an Array. So, by setting “inner_quote_piece” equal to “quote_piece.shift”, we can now return the first element in whatever dimension of the Array we are currently examining. Then, we tell the computer to take that element and insert it into a specific place. In our case, the specific place is our original Array at the index that was previously the index of the first element that was an Array, pushing that element to the next index.</p><p name="ca4a" id="ca4a" class="graf--p graf-after--p">Now, the hard work is done. We simply need to tell our program to keep doing this over and over agin until our original Array is one-dimensional, i.e. none of the elements are themselves Arrays.</p><figure name="e4b4" id="e4b4" class="graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 586px;"><div class="aspect-ratio-fill" style="padding-bottom: 111.60000000000001%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*FhB3ittAkZN8hLo8logckg.png" data-width="952" data-height="1062" data-action="zoom" data-action-value="1*FhB3ittAkZN8hLo8logckg.png"><img src="https://cdn-images-1.medium.com/freeze/max/60/1*FhB3ittAkZN8hLo8logckg.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*FhB3ittAkZN8hLo8logckg.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*FhB3ittAkZN8hLo8logckg.png"></noscript></div></div></figure><p name="8cdc" id="8cdc" class="graf--p graf-after--figure">To the left is our fully organic flatten method.</p><p name="49bb" id="49bb" class="graf--p graf-after--p">Now, let’s look at exactly how this will work when we call “flatten_marquez” on our “buendia” Array.</p><p name="5eae" id="5eae" class="graf--p graf-after--p">We start at “index = 0”, which is “buendia[0]”, which is “Many years later,”. Then, since 0 &lt; “quote_array.length” (which is 3) the computer asks if “buendia[0]” is an Array. It is not an Array, so the computer ignores the second if/else statement and goes straight to “index += 1”, which changes “index” to equal 1, and starts the process over again. Now, we start start the method at “index = 1”, which is “buendia[1]”, which is:</p><blockquote name="8da4" id="8da4" class="graf--blockquote graf-after--p">[“as he faced”, “the firing squad,” [“Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”], “when his father”, “took him to”].</blockquote><p name="1a38" id="1a38" class="graf--p graf-after--blockquote">This is actually the only part of “buendia” that we need to flatten — It’s a two-dimensional Array inside of the Array “buendia”. So, when we start out the method at “buendia[1]”, the computer asks if this element is an Array, and the answer is yes, so the computer enters the block that the previous element skipped. Inside this block, the second if/else statement, the computer first asks if “buendia[1]” is empty. It is not empty, as we can see above, so the computer goes on to set “inner_qoute_piece” equal to “quote_piece.shift”, which sets “inner_qoute_piece” equal to the first element in the “buendia[1]” Array, which is equal to “as he faced”, while also deleting “as he faced” from the original form of “buendia[1]”.</p><blockquote name="3c12" id="3c12" class="graf--blockquote graf-after--p">[<strong class="markup--strong markup--blockquote-strong">“as he faced”</strong>, “the firing squad,” [“Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”], “when his father”, “took him to”].</blockquote><p name="1ca5" id="1ca5" class="graf--p graf-after--blockquote">Finally, the computer tells our original Array, “buendia”, to insert <strong class="markup--strong markup--p-strong">“as he faced” </strong>into “buendia[1]”, which pushed what is left of the original “buendia[1]” to “buendia[2]”. Here’s what “buendia” looks like so far:</p><blockquote name="89f8" id="89f8" class="graf--blockquote graf-after--p">[“Many years later,”, “<strong class="markup--strong markup--blockquote-strong">as he faced</strong>”, [“the firing squad,” [“Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”], “when his father”, “took him to”], “discover ice…”]</blockquote><p name="4a79" id="4a79" class="graf--p graf-after--blockquote">Now, we can go through this exactly 4 more times before anything different happens, so let’s just fast forward to where we see something new:</p><blockquote name="454a" id="454a" class="graf--blockquote graf-after--p">[“Many years later,”, “as he faced”, “the firing squad,” [[“Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”], “when his father”, “took him to”], “discover ice…”]</blockquote><p name="02cb" id="02cb" class="graf--p graf-after--blockquote">When we the computer gets to this point, we see some pretty confusing multi-dimensional shit happen. When the program iterates over “buendia[1..2]” it doesn’t do anything — those elements are already flattened. When it gets to “buendia[3]”, though, the program has to do something new.</p><figure name="3a4d" id="3a4d" class="graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 499px;"><div class="aspect-ratio-fill" style="padding-bottom: 95%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*zsc32ZqyNtE0LAd3P2oRHQ.png" data-width="758" data-height="720" data-action="zoom" data-action-value="1*zsc32ZqyNtE0LAd3P2oRHQ.png"><img src="https://cdn-images-1.medium.com/freeze/max/60/1*zsc32ZqyNtE0LAd3P2oRHQ.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*zsc32ZqyNtE0LAd3P2oRHQ.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*zsc32ZqyNtE0LAd3P2oRHQ.png"></noscript></div></div></figure><p name="1963" id="1963" class="graf--p graf-after--figure">At this point, the program sees that “buendia[3]” is an Array and that it is not empty, prompting the computer to set “inner_quote_piece” equal to “quote_piece.shift”, which is particularly interesting — Previously, when we shifted an element out of an interior Array into our original Array, we were simply moving a String into the original Array. This time around, however, because “buendia[3]” aka “quote_piece” is a multi-dimensional Array, calling shift on it actually returns an Array:</p><blockquote name="8888" id="8888" class="graf--blockquote graf-after--p">quote_piece = [[“Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”], “when his father”, “took him to”]</blockquote><blockquote name="4274" id="4274" class="graf--blockquote graf-after--blockquote">inner_quote_piece = quote_piece.shift = [“Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”]</blockquote><p name="1026" id="1026" class="graf--p graf-after--blockquote">So, now when we assign “inner_quote_piece” to “buendia[3]”, we end up with:</p><blockquote name="40e1" id="40e1" class="graf--blockquote graf-after--p">[“Many years later,”, “as he faced”, “the firing squad,” [“Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”], [“when his father”, “took him to”], “discover ice…”]</blockquote><p name="3758" id="3758" class="graf--p graf-after--blockquote">At this point, we have successfully transformed “buendia” from a three-dimensional Array to a two-dimensional Array. As we continue to iterate through each element in the Array, the same behavior will take place as did in the iteration of the original “buendia[1]” until we end up with our first empty Array. Here is what “buendia” will look like when we get to that point:</p><blockquote name="0408" id="0408" class="graf--blockquote graf-after--p">[“Many years later,”, “as he faced”, “the firing squad,” “Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”, [], [“when his father”, “took him to”], “discover ice…”]</blockquote><p name="b993" id="b993" class="graf--p graf-after--blockquote">Now, when the computer iterates through this version of “buendia” it will have its first opportunity to answer “yes” to the question “quote_piece.empty”.</p><figure name="d2d8" id="d2d8" class="graf--figure graf--layoutOutsetLeft graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 525px; max-height: 131px;"><div class="aspect-ratio-fill" style="padding-bottom: 25%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*WSw-KoAsVss4Gu1NxVR72g.png" data-width="712" data-height="178" data-action="zoom" data-action-value="1*WSw-KoAsVss4Gu1NxVR72g.png"><img src="https://cdn-images-1.medium.com/freeze/max/60/1*WSw-KoAsVss4Gu1NxVR72g.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*WSw-KoAsVss4Gu1NxVR72g.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*WSw-KoAsVss4Gu1NxVR72g.png"></noscript></div></div></figure><p name="c9cd" id="c9cd" class="graf--p graf-after--figure">Since “quote_piece” will in fact be empty, the computer will enter the block and delete the empty Array at “buendia[7]”, only leaving us with three more iterations until we have successfully flattened “buendia”:</p><blockquote name="b831" id="b831" class="graf--blockquote graf-after--p">[“Many years later,”, “as he faced”, “the firing squad,” “Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”, [“when his father”, “took him to”], “discover ice…”]</blockquote><p name="b9f1" id="b9f1" class="graf--p graf-after--blockquote">As for the remaining iterations, they exhibit all of the same computer responses we have already seen. The two Strings in the Array at “buendia[7]” will be shifted into the first dimension, the empty Array will be deleted, and, finally, we will be left with a one-dimensional “buendia”:</p><blockquote name="93e9" id="93e9" class="graf--blockquote graf-after--p">[“Many years later,”, “as he faced”, “the firing squad,” “Colonel Aureliano Buendia”, “was to remember”, “that distant afternoon”, “when his father”, “took him to”, “discover ice…”]</blockquote><p name="bc48" id="bc48" class="graf--p graf-after--blockquote">Here’s where we see there is always more magic to know, but hopefully realize it’s not quite magic at all.</p><p name="4890" id="4890" class="graf--p graf-after--p">Call “flatten_marquez(buendia).join(“ “) and enjoy a quote by the father of Magical Realism. No, not Yukihiro Matsumoto…</p><blockquote name="cdfe" id="cdfe" class="graf--blockquote graf--startsWithDoubleQuote graf-after--p">“Many years later, as he faced the firing squad, Colonel Aureliano Buendía was to remember that distant afternoon when his father took him to discover ice…”</blockquote><p name="0392" id="0392" class="graf--p graf-after--blockquote">N</p><figure name="4fd6" id="4fd6" class="graf--figure graf--iframe graf-after--p graf--last"><div class="iframeContainer"><iframe width="700" height="250" src="/media/e43df8e68405d935217f800164663fc0?maxWidth=700" data-media-id="e43df8e68405d935217f800164663fc0" frameborder="0"></iframe></div></figure></div></div></section>
</section>
<footer><p>Exported from <a href="https://medium.com">Medium</a> on January 22, 2016.</p><p><a href="https://medium.com/p/3a639a334e06">View the original</a></p></footer></article>

</body></html>